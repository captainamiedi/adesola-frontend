"use strict";(self.webpackChunkadesola_frontend=self.webpackChunkadesola_frontend||[]).push([[135],{6135:function(e,t,a){a.r(t),a.d(t,{default:function(){return j}});var n=a(3433),s=a(4165),r=a(5861),o=a(9439),c=a(2791),i=a(1243),l=a(6090),u=a(184),d=function(e){var t=e.message,a=e.formatMessageContent;e.chatText;return(0,u.jsx)("div",{className:"message ".concat("user"===t.role?"user":"assistant"),dangerouslySetInnerHTML:{__html:a(t.content)}})},p=a(9135),h=function(e){var t=e.inputMessage,a=e.setInputMessage,n=e.sendMessage,s=e.mode,r=e.handleFileChange,o=e.sendFile,c=e.file,i=e.type;return(0,u.jsxs)("div",{className:"chat-input",children:[("lawChat"===s||"Q/A"===s&&"answer"===i)&&(0,u.jsx)("textarea",{placeholder:"Type a message",value:t,onChange:function(e){return a(e.target.value)},onKeyDown:function(e){"Enter"!==e.key||e.shiftKey||(e.preventDefault(),t&&n())}}),f.includes(s)&&"answer"!==i&&(0,u.jsx)("input",{type:"file",onChange:r,onKeyDown:function(e){"Enter"!==e.key||e.shiftKey||(e.preventDefault(),c&&o())}}),"Q/A"!==s&&"answer"!==i&&(0,u.jsx)("button",{onClick:n,disabled:"lawChat"===s&&!t||"lawChat"!==s&&!c||"Q/A"===s&&!t,children:(0,u.jsx)(p.Y2X,{})}),"Q/A"===s&&(0,u.jsx)("button",{onClick:n,disabled:"question"===i&&!c||"answer"===i&&!t,children:(0,u.jsx)(p.Y2X,{})})]})},f=["Q/A","audio","summarizeDoc","question"],m=function(e){var t=e.messages,a=e.inputMessage,n=e.setInputMessage,s=e.sendMessage,r=e.formatMessageContent,o=e.isAssistantTyping,c=e.messagesEndRef,i=e.chatText,l=e.mode,p=e.file,f=e.handleFileChange,m=e.sendFile,g=e.type;return(0,u.jsxs)("div",{className:"chat-ui",children:[(0,u.jsxs)("div",{className:"chat-messages",children:[t.map((function(e,t){return(0,u.jsx)(d,{message:e,formatMessageContent:r,chatText:i},t)})),o&&(0,u.jsx)("div",{className:"message assistant",children:(0,u.jsxs)("div",{className:"typing-indicator",children:[(0,u.jsx)("span",{className:"dot"}),(0,u.jsx)("span",{className:"dot"}),(0,u.jsx)("span",{className:"dot"})]})}),(0,u.jsx)("div",{ref:c})]}),(0,u.jsx)(h,{inputMessage:a,setInputMessage:n,sendMessage:s,mode:l,file:p,sendFile:m,handleFileChange:f,type:g})]})};function g(e){var t=e.setMode,a=(e.mode,e.setType);return(0,u.jsx)("div",{className:"chat-mode-sub-container",children:(0,u.jsxs)("div",{className:"select-wrapper",children:[(0,u.jsx)("label",{for:"select-choice",children:"Chat Mode:"}),(0,u.jsx)("div",{className:"styled-select",for:"select-choice",children:(0,u.jsxs)("select",{name:"select-choice",id:"select-choice",onChange:function(e){t(e.target.value),a("question")},children:[(0,u.jsx)("option",{value:"lawChat",children:"Law Chat"}),(0,u.jsx)("option",{value:"summarizeDoc",children:"Summarize Document"}),(0,u.jsx)("option",{value:"audio",children:"Translate Audio"}),(0,u.jsx)("option",{value:"question",children:"Question"}),(0,u.jsx)("option",{value:"Q/A",children:"Q/A Document"})]})})]})})}var x=(0,l.eI)("https://gpidqxxkwiudcyrgykll.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdwaWRxeHhrd2l1ZGN5cmd5a2xsIiwicm9sZSI6ImFub24iLCJpYXQiOjE2ODMzNDU2ODMsImV4cCI6MTk5ODkyMTY4M30.FscwJ6j8QO7gzcy3nXjhnUT47LFAfEpMFzH-_hOdZqw"),v="https://adesola.onrender.com/";var j=function(){var e=(0,c.useState)([]),t=(0,o.Z)(e,2),a=t[0],l=t[1],d=(0,c.useState)(null),p=(0,o.Z)(d,2),h=p[0],f=p[1],j=(0,c.useState)([]),w=(0,o.Z)(j,2),b=w[0],y=w[1],k=(0,c.useState)(""),Z=(0,o.Z)(k,2),I=Z[0],C=Z[1],M=(0,c.useRef)(null),A=(0,c.useState)(!1),S=(0,o.Z)(A,2),N=S[0],F=S[1],T=(0,c.useState)(""),D=(0,o.Z)(T,2),q=D[0],z=D[1],E=(0,c.useState)("lawChat"),Q=(0,o.Z)(E,2),O=Q[0],_=Q[1],J=(0,c.useState)("question"),R=(0,o.Z)(J,2),X=R[0],Y=R[1],K=(0,c.useState)(null),L=(0,o.Z)(K,2),U=L[0],W=L[1];(0,c.useEffect)((function(){if(U){var e=new FileReader;e.onload=function(e){var t=e.target.result;localStorage.setItem("storedFile",t),localStorage.setItem("storedFileName",U.name)},e.readAsDataURL(U)}}),[U]),(0,c.useEffect)((function(){P()}),[b]);var P=function(){M.current&&M.current.scrollIntoView({behavior:"auto"})},H=function(){var e=(0,r.Z)((0,s.Z)().mark((function e(){var t,a,r,o,c,l,u,d,p,h,f,m,g,x,j,w,k,Z,C;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=localStorage.getItem("storedFile"),a=localStorage.getItem("storedFileName"),r=t.replace(/^data:[^;]+;base64,/,""),o=atob(r),c=[],l=0;l<o.length;l++)c.push(o.charCodeAt(l));if(u=new Uint8Array(c),d=new Blob([u],{type:"application/pdf"}),p=new File([d],a,{type:"application/pdf"}),y([].concat((0,n.Z)(b),"answer"===X?[{content:I,role:"user"}]:[{content:a,role:"user"}])),h={headers:{Authorization:localStorage.getItem("userToken")}},(f=new FormData).append("file",p),F(!0),"audio"!==O){e.next=22;break}return e.next=17,i.Z.post("".concat(v,"api/upload_media/"),f,h);case 17:m=e.sent,g={role:"assistant",content:m.data.data},y((function(e){return[].concat((0,n.Z)(e),[g])})),F(!1),W(null);case 22:if("summarizeDoc"!==O){e.next=31;break}return e.next=25,i.Z.post("".concat(v,"api/upload_file/"),f,h);case 25:x=e.sent,j={role:"assistant",content:x.data.data.output_text},console.log(x.data.data),y((function(e){return[].concat((0,n.Z)(e),[j])})),F(!1),W(null);case 31:if("question"!==O){e.next=46;break}return e.prev=32,f.append("type","question"),e.next=36,i.Z.post("".concat(v,"api/question_answer"),f,h);case 36:w=e.sent,k={role:"assistant",content:w.data.data},"answer"===X&&(k.content=w.data.data.data.answer),y((function(e){return[].concat((0,n.Z)(e),[k])})),F(!1),W(null),e.next=46;break;case 44:e.prev=44,e.t0=e.catch(32);case 46:if("Q/A"!==O){e.next=68;break}if(e.prev=47,"answer"!==X){e.next=57;break}return f.append("question",I),e.next=52,i.Z.post("".concat(v,"api/query/doc"),f,{headers:{Authorization:localStorage.getItem("userToken")}});case 52:return Z=e.sent,C={role:"assistant",content:Z.data.data.answer+Z.data.data.sources},y((function(e){return[].concat((0,n.Z)(e),[C])})),F(!1),e.abrupt("return",Z.data);case 57:return e.next=59,fetch("".concat(v,"api/embedding/doc"),{method:"POST",headers:{Authorization:localStorage.getItem("userToken")},body:f});case 59:e.sent,alert("upload successful. you can start asking Adesola questions based on the document uploaded."),F(!1),W(null),Y("answer"),e.next=68;break;case 66:e.prev=66,e.t1=e.catch(47);case 68:case"end":return e.stop()}}),e,null,[[32,44],[47,66]])})));return function(){return e.apply(this,arguments)}}(),V=function(){var e=(0,r.Z)((0,s.Z)().mark((function e(){var t,r,o;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(y([].concat((0,n.Z)(b),[{content:I,role:"user"}])),C(""),!["summarizeDoc","audio","Q/A"].includes(O)){e.next=4;break}return e.abrupt("return",H());case 4:if(F(!0),"answer"===X){e.next=34;break}return e.prev=6,1e3+1e3*Math.random(),e.prev=8,e.next=11,x.functions.invoke("law-custom-data",{body:JSON.stringify({query:I})});case 11:t=e.sent,r=t.data,t.error,z(r.text),o={role:"assistant",content:r.text},y((function(e){return[].concat((0,n.Z)(e),[o])})),h||(f(r.id),l([{id:r.id}].concat((0,n.Z)(a)))),e.next=24;break;case 20:e.prev=20,e.t0=e.catch(8),console.error("Error sending message:",e.t0),y([].concat((0,n.Z)(b),[{content:"\u26a0\ufe0f An error occurred while sending the message. Please make sure the backend is running and OPENAI_API_KEY is set in the .env file.",role:"assistant"}]));case 24:return e.prev=24,F(!1),e.finish(24);case 27:e.next=32;break;case 29:e.prev=29,e.t1=e.catch(6),console.error("Error sending message:",e.t1);case 32:e.next=34;break;case 34:case"end":return e.stop()}}),e,null,[[6,29],[8,20,24,27]])})));return function(){return e.apply(this,arguments)}}();return(0,u.jsxs)("div",{className:"App",children:[(0,u.jsx)("div",{className:"headline",children:(0,u.jsx)("h1",{children:"\u26a1 Adesola Chat \u26a1"})}),(0,u.jsxs)("div",{className:"chat-container",children:[(0,u.jsx)(m,{messages:b,inputMessage:I,setInputMessage:C,sendMessage:V,formatMessageContent:function(e){return e.split(/(```[\s\S]*?```|`[\s\S]*?`)/g).map((function(e){if(e.startsWith("```")&&e.endsWith("```")){var t=(e=e.split("\n").slice(1).join("\n")).substring(0,e.length-3);return'<pre><code class="code-block">'.concat(t,"</code></pre>")}if(e.startsWith("`")&&e.endsWith("`")){var a=e.substring(1,e.length-1);return'<code class="inline-code">'.concat(a,"</code>")}return e.replace(/\n/g,"<br>")})).join("")},isAssistantTyping:N,messagesEndRef:M,chatText:q,mode:O,file:U,handleFileChange:function(e){var t=e.target.files[0];W(t)},sendFile:H,type:X}),(0,u.jsx)("div",{className:"chat-option-container",children:(0,u.jsx)(g,{setMode:_,mode:O,setType:Y})})]})]})}}}]);
//# sourceMappingURL=135.d21306a1.chunk.js.map